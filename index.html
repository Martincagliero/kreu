<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Krautermeister - Origen y carácter</title>
  <link rel="preconnect" href="https://fonts.googleapis.com" />
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
  <link href="https://fonts.googleapis.com/css2?family=Playfair+Display:wght@400;600;700&family=Manrope:wght@300;400;500;600&display=swap" rel="stylesheet" />
  <link rel="stylesheet" href="style.css" />
  <!-- Three.js & Loaders - Local files for same-origin reliability -->
  <script src="three.min.js"></script>
  <script src="GLTFLoader.js"></script>
  <script src="DRACOLoader.js"></script>
</head>
<body>
  <div class="cursor" aria-hidden="true"></div>

  <div id="preloader" class="preloader" aria-live="polite">
    <div class="preloader__wrap">
      <div class="preloader__logo" aria-hidden="true">
        <img src="logo.png" alt="" />
      </div>
      <div class="preloader__bottle" role="img" aria-label="Botella minimalista">
        <div class="preloader__sweep" aria-hidden="true"></div>
        <div class="preloader__particles" aria-hidden="true">
          <span></span><span></span><span></span><span></span><span></span>
          <span></span><span></span><span></span><span></span><span></span>
        </div>
        <svg viewBox="0 0 120 320" class="bottle" xmlns="http://www.w3.org/2000/svg">
          <defs>
            <linearGradient id="liquidGradient" x1="0" x2="0" y1="1" y2="0">
              <stop offset="0" stop-color="#1b3a2b" />
              <stop offset="1" stop-color="#2a4f3c" />
            </linearGradient>
            <filter id="liquidGlow" x="-60%" y="-60%" width="220%" height="220%">
              <feGaussianBlur stdDeviation="6" result="blur" />
              <feMerge>
                <feMergeNode in="blur" />
                <feMergeNode in="SourceGraphic" />
              </feMerge>
            </filter>
          </defs>
          <path class="bottle-outline" d="M48 12h24v26c0 6 4 10 8 12 8 4 14 12 14 22v188c0 22-18 40-40 40s-40-18-40-40V72c0-10 6-18 14-22 4-2 8-6 8-12V12z" />
          <rect class="bottle-liquid" x="24" y="268" width="72" height="0" rx="10" ry="10" />
          <path class="bottle-neck" d="M48 12h24v26c0 6 4 10 8 12 2 1 4 2 6 4H34c2-2 4-3 6-4 4-2 8-6 8-12V12z" />
        </svg>
      </div>
      <div class="preloader__percent">
        <span id="loaderValue">0%</span>
      </div>
      <p class="preloader__label">Destilando un ritual oscuro</p>
    </div>
  </div>

  <header class="navbar" id="navbar">
    <div class="navbar__inner">
      <div class="logo">
        <img src="logo.png" alt="Krautermeister" class="logo__img" />
        <span>KRAUTERMEISTER</span>
      </div>
      <nav class="nav">
        <a href="#origen">Origen</a>
        <a href="#bottle">Botella</a>
        <a href="#editorial">Editorial</a>
        <a href="#ritual">Ritual</a>
      </nav>
      <button class="nav-cta">Reservar</button>
    </div>
  </header>

  <main>
    <section class="hero" id="origen">
      <div class="hero__video">
        <video autoplay muted loop playsinline preload="auto" poster="">
          <source src="video.mp4" type="video/mp4" />
        </video>
        <div class="hero__overlay"></div>
        <div class="hero__gradient" aria-hidden="true"></div>
      </div>
      <div class="hero__content">
        <p class="eyebrow">Licor argentino de autor</p>
        <h1 class="hero__title">
          <span class="hero__line hero__glow-line">ORIGEN Y</span>
          <span class="hero__line hero__glow-line">CARÁCTER OSCURO.</span>
          <span class="hero__line hero__line--accent hero__glow-line">HERBAL.</span>
          <span class="hero__line hero__glow-line">INOLVIDABLE.</span>
        </h1>
        <p class="hero__text hero__glow-text">Un perfil herbal profundo, afinado con paciencia europea y alma patagónica.</p>
        <div class="hero__actions">
          <button class="btn primary btn--liquid">Explorar</button>
          <button class="btn ghost btn--liquid">Ver origen</button>
        </div>
      </div>
      <div class="hero__glow" aria-hidden="true"></div>
      <div class="hero__light-reflections" aria-hidden="true">
        <div class="reflection reflection-1"></div>
        <div class="reflection reflection-2"></div>
      </div>
    </section>

    <section class="bottle-section" id="bottle">
      <div class="bottle-section__canvas-wrapper">
        <canvas id="bottle3d" class="bottle-3d-canvas"></canvas>
        <div class="bottle-3d-halo" aria-hidden="true"></div>
        <div class="bottle-3d-halo bottle-3d-halo--secondary" aria-hidden="true"></div>
        <div class="bottle-3d-particles" aria-hidden="true">
          <span class="bottle-3d-particle"></span>
          <span class="bottle-3d-particle"></span>
          <span class="bottle-3d-particle"></span>
          <span class="bottle-3d-particle"></span>
          <span class="bottle-3d-particle"></span>
          <span class="bottle-3d-particle"></span>
          <span class="bottle-3d-particle"></span>
          <span class="bottle-3d-particle"></span>
        </div>
        <div class="bottle-3d-light-stream" aria-hidden="true"></div>
      </div>
      <div class="bottle-section__text reveal">
        <h2 class="section-title">La botella como amuleto</h2>
        <div class="bottle-mystique">
          <p class="bottle-copy">
            <span class="copy-line line-1">Una silueta que no busca llamar,</span>
            <span class="copy-line line-2">sino atraer. <span class="keyword-glow">Oscura</span>, serena,</span>
            <span class="copy-line line-3">con un <span class="keyword-glow">brillo sutil</span> que revela su esencia.</span>
          </p>
          <div class="text-aura" aria-hidden="true"></div>
        </div>
      </div>
    </section>

    <section class="editorial" id="editorial">
      <!-- Background Elements -->
      <div class="editorial__bg"></div>
      <div class="editorial__noise" aria-hidden="true"></div>
      
      <!-- Mystical Particles -->
      <div class="editorial__particles" aria-hidden="true">
        <div class="edit-particle edit-particle-1"></div>
        <div class="edit-particle edit-particle-2"></div>
        <div class="edit-particle edit-particle-3"></div>
        <div class="edit-particle edit-particle-4"></div>
        <div class="edit-particle edit-particle-5"></div>
        <div class="edit-particle edit-particle-6"></div>
      </div>

      <!-- Floating Smoke/Haze Effect -->
      <div class="editorial__haze" aria-hidden="true">
        <div class="haze-layer haze-1"></div>
        <div class="haze-layer haze-2"></div>
        <div class="haze-layer haze-3"></div>
      </div>

      <!-- Halo Light from Bottle -->
      <div class="editorial__halo-glow" aria-hidden="true"></div>
      
      <!-- Flowing Light Stream -->
      <div class="editorial__light-stream" aria-hidden="true"></div>
      
      <div class="editorial__watermark" aria-hidden="true">
        <img src="logo.png" alt="" />
      </div>

      <div class="editorial__intro">
        <h2 class="section-title editorial__title">
          <span class="editorial__line editorial__line-animated">Editorial</span>
          <span class="editorial__line editorial__line-animated">herbal</span>
        </h2>
        <p class="editorial__subtitle">Fragmentos visuales, texturas y sombras que hablan del <span class="keyword-highlight">origen</span> y <span class="keyword-highlight">carácter</span>.</p>
      </div>

      <div class="editorial__story">
        <article class="editorial__scene scene--wide">
          <div class="editorial__media clip-animate clip-a drift-x" data-depth="0.18" data-drift="-60" data-rotate="2">
            <img src="kreu1.jpg" alt="Bosque herbal" />
            <span class="editorial__veil"></span>
            <span class="editorial__sweep"></span>
          </div>
          <div class="editorial__text">
            <h3 class="scene__title">La penumbra del bosque</h3>
            <p class="scene__description">Notas verdes, <span class="keyword-glow-text">musgo oscuro</span> y una calma que sugiere tiempo. El <span class="keyword-glow-text">misterio</span> nace en silencio.</p>
          </div>
        </article>

        <div class="editorial__phrase editorial__phrase--animated">El <span class="phrase-keyword">silencio</span> también se bebe.</div>

        <div class="editorial__scene scene--fullscreen">
          <div class="editorial__media fullscreen-media" data-depth="0.06">
            <img src="kreu4.jpg" alt="Luz sobre botanicos" />
            <span class="editorial__veil"></span>
          </div>
          <div class="editorial__overlay-text">
            <h3 class="scene__title">Un plano extendido</h3>
            <p class="scene__description">La <span class="keyword-glow-text">luz</span> cae despacio. El perfil herbal se abre y se queda, como un <span class="keyword-glow-text">recuerdo europeo</span>.</p>
          </div>
        </div>

        <div class="editorial__phrase editorial__phrase--xl editorial__phrase--animated">Nada es casual. <span class="phrase-keyword">Todo es herbal.</span></div>

        <article class="editorial__scene scene--closing">
          <div class="editorial__media clip-animate clip-e drift-x tilt-left" data-depth="0.12" data-drift="-40" data-rotate="2">
            <img src="kreu1.jpg" alt="Textura" />
            <span class="editorial__veil"></span>
            <span class="editorial__sweep"></span>
          </div>
          <div class="editorial__text">
            <h3 class="scene__title">Final largo, memoria viva</h3>
            <p class="scene__description">Una estética <span class="keyword-glow-text">sobria</span> que respira. <span class="keyword-glow-text">Oscura</span>, herbal, <span class="keyword-glow-text">inolvidable</span>.</p>
          </div>
        </article>
      </div>
    </section>

    <section class="ritual" id="ritual">
      <div class="ritual__content reveal">
        <h2 class="section-title">Ritual nocturno</h2>
        <p>La experiencia Krautermeister invita a bajar el ritmo. Sabor oscuro, final largo, memoria persistente.</p>
        <button class="btn primary">Agendar cata</button>
      </div>
      <div class="watermark">
        <img src="logo.png" alt="Krautermeister" class="watermark__logo" />
      </div>
    </section>
  </main>

  <footer class="footer">
    <p>2026 Krautermeister. Buenos Aires.</p>
  </footer>

  <!-- GSAP -->
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.14.0/dist/gsap.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.14.0/dist/ScrollTrigger.min.js"></script>
  
  <!-- 3D Bottle Initialization - ROBUST VERSION -->
  <script>
    window.addEventListener('load', () => {
      console.log('📄 Page loaded. Initializing 3D bottle...');
      
      // Ensure Three.js is available
      if (typeof THREE === 'undefined') {
        console.error('❌ Three.js not loaded. Check local three.min.js file.');
        return;
      }

      const canvas = document.getElementById('bottle3d');
      if (!canvas) {
        console.error('❌ Canvas #bottle3d not found');
        return;
      }

      // 3D Scene Setup
      const scene = new THREE.Scene();
      scene.background = new THREE.Color(0x0a1410);
      
      const camera = new THREE.PerspectiveCamera(
        30,
        canvas.clientWidth / canvas.clientHeight,
        0.1,
        1000
      );
      camera.position.set(0, 1.2, 6);

      const renderer = new THREE.WebGLRenderer({ 
        canvas: canvas, 
        antialias: true, 
        alpha: true 
      });
      renderer.setSize(canvas.clientWidth, canvas.clientHeight);
      renderer.setPixelRatio(window.devicePixelRatio);

      // Lighting
      const ambientLight = new THREE.AmbientLight(0xffffff, 0.5);
      scene.add(ambientLight);

      const directionalLight = new THREE.DirectionalLight(0xff9944, 0.8);
      directionalLight.position.set(3, 3, 3);
      scene.add(directionalLight);

      // Load 3D Model
      const loader = new THREE.GLTFLoader();
      
      // Configure DRACO if available
      if (typeof THREE.DRACOLoader !== 'undefined') {
        const dracoLoader = new THREE.DRACOLoader();
        dracoLoader.setDecoderPath('draco/');
        dracoLoader.setDecoderConfig({ type: 'js' });
        loader.setDRACOLoader(dracoLoader);
        console.log('✅ DRACOLoader configured with local JS decoder');
      }

      loader.load(
        'bottle-v1.glb',
        (gltf) => {
          console.log('✅ bottle-v1.glb loaded successfully');
          const bottle = gltf.scene;
          bottle.scale.set(0.6, 0.6, 0.6);
          bottle.position.set(0, -0.4, 0);
          scene.add(bottle);
          
          // Animation: Continuous rotation with requestAnimationFrame
          let isAnimating = true;
          
          function animateBottle() {
            if (isAnimating) {
              bottle.rotation.y += 0.005;
              renderer.render(scene, camera);
              requestAnimationFrame(animateBottle);
            }
          }
          animateBottle();
          
          // GSAP animation for 3D bottle (animate Three.js object, not HTML elements)
          if (typeof gsap !== 'undefined') {
            gsap.to(bottle.rotation, {
              y: bottle.rotation.y + Math.PI * 2,
              duration: 15,
              repeat: -1,
              ease: 'none'
            });
            console.log('✅ GSAP 3D animation applied');
          }
        },
        (progress) => {
          const percent = Math.round((progress.loaded / progress.total) * 100);
          console.log(`📥 Loading: ${percent}%`);
        },
        (error) => {
          console.error('❌ Error loading bottle-v1.glb:', error);
          console.warn('💡 Make sure bottle-v1.glb exists in the root directory');
        }
      );

      // Handle window resize
      window.addEventListener('resize', () => {
        const width = canvas.clientWidth;
        const height = canvas.clientHeight;
        camera.aspect = width / height;
        camera.updateProjectionMatrix();
        renderer.setSize(width, height);
      });

      console.log('✅ 3D bottle initialization complete');
    });
  </script>

  <!-- Main Script (GSAP animations) -->
  <script src="main.js"></script>
</body>
</html>
