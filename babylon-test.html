<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Botella 3D con Babylon.js</title>
  <style>
    * { margin: 0; padding: 0; }
    html, body { width: 100%; height: 100%; overflow: hidden; }
    #canvas { display: block; width: 100%; height: 100%; }
    #status {
      position: fixed;
      top: 20px;
      right: 20px;
      padding: 15px 20px;
      background: #f59e0b;
      color: white;
      border-radius: 8px;
      font-weight: bold;
      z-index: 1000;
    }
    #status.success { background: #4ade80; }
    #status.error { background: #ef4444; }
  </style>
</head>
<body>
  <canvas id="canvas"></canvas>
  <div id="status">‚è≥ Cargando...</div>

  <!-- Babylon.js (incluye DRACO incorporado) -->
  <script src="https://cdn.babylonjs.com/babylon.js"></script>
  <script src="https://cdn.babylonjs.com/loaders/babylonjs.loaders.min.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/gsap@3.14.0/dist/gsap.min.js"></script>

  <script>
    window.addEventListener('load', () => {
      console.log('üöÄ Inicializando Babylon.js...');
      
      const canvas = document.getElementById('canvas');
      const engine = new BABYLON.Engine(canvas, true);
      
      // Crear escena
      const scene = new BABYLON.Scene(engine);
      scene.clearColor = new BABYLON.Color3(0.04, 0.09, 0.06);
      
      // C√°mara
      const camera = new BABYLON.ArcRotateCamera(
        'camera',
        Math.PI / 2,
        Math.PI / 2.5,
        5,
        BABYLON.Vector3.Zero(),
        scene
      );
      camera.attachControl(canvas, true);
      
      // Luces
      const light = new BABYLON.HemisphericLight('light', new BABYLON.Vector3(0, 1, 0), scene);
      light.intensity = 0.7;
      
      const pointLight = new BABYLON.PointLight('pointLight', new BABYLON.Vector3(2, 3, 2), scene);
      pointLight.intensity = 0.8;
      pointLight.range = 100;
      
      // Cargar modelo
      console.log('‚è≥ Cargando bottle-v1.glb (con DRACO)...');
      
      BABYLON.SceneLoader.ImportMesh(
        "",
        "",
        "bottle-v1.glb",
        scene,
        (meshes, particleSystems, skeletons, animationGroups) => {
          console.log('‚úÖ BOTELLA CARGADA EXITOSAMENTE');
          console.log('Meshes:', meshes.length);
          
          // Obtener el modelo
          const bottle = meshes[0];
          bottle.scaling.set(2, 2, 2);
          
          document.getElementById('status').textContent = '‚úÖ Botella cargada';
          document.getElementById('status').classList.add('success');
          
          // Animaci√≥n de rotaci√≥n con GSAP
          gsap.to(bottle.rotation, {
            y: Math.PI * 2,
            duration: 8,
            repeat: -1,
            ease: 'none'
          });
          
          console.log('üéâ Botella girando');
        },
        (progress) => {
          const percent = Math.round((progress.loaded / progress.total) * 100);
          if (!isNaN(percent)) {
            console.log(`üì• Progreso: ${percent}%`);
          }
        },
        (error) => {
          console.error('‚ùå Error al cargar:', error);
          document.getElementById('status').textContent = '‚ùå ' + error.message;
          document.getElementById('status').classList.add('error');
        }
      );
      
      // Render loop
      engine.runRenderLoop(() => {
        scene.render();
      });
      
      // Resize
      window.addEventListener('resize', () => {
        engine.resize();
      });
    });
  </script>
</body>
</html>
